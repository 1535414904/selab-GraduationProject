# 🔥 模擬退火演算法設計於手術排程應用

本研究針對具備實務限制的手術排程問題，設計一套基於模擬退火（Simulated Annealing, SA）之啟發式排程方法。該演算法具備良好之搜尋彈性與動態調整能力，透過鏈結串列結構表示排程內容，並結合自適應溫度控制機制，有效提升整體解品質與演算穩定性。

---

## 🔗 1. 編碼結構：鏈結串列建模

- 每間手術房對應一條鏈結串列（Linked List），每個節點代表一項手術。
- 此編碼方式便於操作手術順序的「插入」與「置換」，同時保留房型限制檢查機制。
- 排程解可動態調整順序，並直接反映在手術房使用情境上，具高實務可行性。

---

## 🔰 2. 初始解生成與溫度設定

### 初始解策略：
- 採用以下三種派遣規則產生初始解：
  - FCFS（First-Come, First-Served）：具公平性，可能造成長時手術延遲。
  - SPT（Shortest Processing Time）：有效降低平均等待時間。
  - LPT（Longest Processing Time）：能避免長時手術排到太晚。
- 三者取成本最小者作為演算法初始現行解。

### 初始溫度設定：
- 採用 **SALO 策略（二分搜尋法）** 自動設定初始溫度，使擾動接受率約為 50%，提供穩定起點：
  - 若接受率 < 50%，提高溫度。
  - 若接受率 > 50%，降低溫度。
  - 持續調整直至接近預設接受率。

---

## 🔄 3. 擾動操作與鄰域解產生

- 在每一輪迭代中，隨機從現行排程中選擇一間手術房並執行下列任一擾動：
  - **插入（Insertion）**：將一項手術插入至新位置。
  - **置換（Swap）**：交換兩筆手術的執行順序。
- 每次擾動會產生多組候選解，從中挑選成本最低者作為候選解進入接受階段。

---

## ✅ 4. 解接受策略（模擬退火準則）

- 若候選解優於現行解，則直接接受。
- 若候選解較差，則依據下列機率接受（模擬退火機制）：

$$
\Delta E = \text{Cost}(S_{\text{new}}) - \text{Cost}(S_{\text{current}})
$$

$$
p = \exp\left(-\frac{\Delta E}{T}\right)
$$

- 藉此機制允許偶爾接受劣解以跳脫局部最小值。

---

## ❄️ 5. 冷卻機制與動態溫度調整

### 冷卻策略：
- 採用**指數式冷卻法**進行溫度遞減：

$$
T_{\text{new}} = \alpha \cdot T_{\text{current}}, \quad \alpha \in [0.95, 0.99]
$$

### 動態調整 α：
- 接受率過高 → 降低 α（快速降溫，加快收斂）。
- 接受率過低 → 提高 α（慢速降溫，強化探索）。

### 重啟策略：
- 若連續多輪解品質無改善，則暫時升溫，藉以跳脫局部最小值陷阱。

---

## ⏹ 6. 終止條件

- 當 **評估函數（成本函數）呼叫次數**超過預設上限，演算法即自動終止。
- 最終輸出目前已知的最低成本排程解。

---

## ✨ 小結

本演算法結合：

- 鏈結串列結構的彈性建模能力  
- 動態調溫與接受率控制機制  
- 多元初始策略與擾動操作  

成功提升在具備多重限制與高變異性的手術排程問題中的解品質與穩定性，適用於真實醫療環境中高效率資源配置場景。
